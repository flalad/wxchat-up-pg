# 管理员设置指南 v2.2.0

本指南将帮助您设置和配置微信文件传输助手的管理员账户。

## 🚨 重要更新

**从 v2.2.0 开始，系统不再使用默认管理员账户。您必须通过环境变量设置管理员凭据。**

## 🚀 快速开始

### 1. 设置环境变量

在部署项目之前，您必须设置以下环境变量：

```bash
# 管理员用户名（必需）
ADMIN_USERNAME=your_admin_username

# 管理员密码（必需）
ADMIN_PASSWORD=your_secure_password
```

#### Cloudflare Pages 设置方法：
1. 登录 Cloudflare Dashboard
2. 进入您的 Pages 项目
3. 转到 Settings > Environment variables
4. 添加以下变量：
   - `ADMIN_USERNAME`: 您的管理员用户名
   - `ADMIN_PASSWORD`: 您的安全密码

#### 本地开发设置方法：
在项目根目录创建 `.dev.vars` 文件：
```bash
ADMIN_USERNAME=your_admin_username
ADMIN_PASSWORD=your_secure_password
```

### 2. 数据库初始化

确保您的数据库已经正确设置。如果还没有设置，请参考 `DATABASE_SETUP.md`。

### 3. 初始化管理员账户

设置环境变量后，访问以下URL来初始化管理员账户：

```
POST /api/auth/init-admin
```

或者直接在浏览器中访问管理后台，系统会自动引导您完成初始化。

### 4. 访问管理后台

初始化完成后，您可以通过以下方式访问管理后台：

1. 访问 `/admin.html`
2. 使用您在环境变量中设置的凭据登录
3. 开始管理您的系统

## 🔒 安全改进

### 新的安全特性：
- ✅ 移除了默认管理员账户
- ✅ 强制使用环境变量设置凭据
- ✅ 登录页面不再显示默认账户信息
- ✅ 更安全的部署流程

### 密码要求：
- 建议使用至少 12 个字符
- 包含大小写字母、数字和特殊字符
- 避免使用常见密码

## 🎨 功能特性

### 全新UI设计
- 现代化玻璃态设计
- 流畅的动画效果
- 响应式布局
- 深色/浅色主题支持

### 📊 仪表板
- 系统概览和统计信息
- 实时用户活动图表
- 文件类型分布分析
- 最近注册用户列表

### 👥 用户管理
- 查看所有注册用户
- 管理用户状态（启用/禁用）
- 查看用户统计信息
- 用户角色管理
- 批量操作支持

### 💬 消息管理
- 查看所有消息记录
- 按类型筛选消息
- 高级搜索功能
- 消息统计分析
- 导出功能

### 📁 文件管理
- 查看所有上传文件
- 文件类型筛选
- 批量删除功能
- 存储使用统计
- 文件预览

## 🔧 故障排除

### 环境变量未设置
**错误**: "请在环境变量中设置 ADMIN_USERNAME 和 ADMIN_PASSWORD"

**解决方案**:
1. 确认已正确设置环境变量
2. 重新部署项目
3. 检查变量名称是否正确

### 无法访问管理后台
1. 检查数据库连接
2. 确认管理员账户已初始化
3. 检查浏览器控制台错误
4. 验证环境变量设置

### 忘记管理员密码
1. 更新环境变量中的密码
2. 重新部署项目
3. 或通过数据库直接重置

### 数据显示异常
1. 检查API端点是否正常
2. 查看浏览器网络请求
3. 检查数据库数据完整性
4. 清除浏览器缓存

## 📈 迁移指南

### 从旧版本升级：
1. 设置环境变量 `ADMIN_USERNAME` 和 `ADMIN_PASSWORD`
2. 重新部署项目
3. 使用新的凭据登录
4. 旧的默认账户将不再有效

## 🛠️ 技术支持

如果您遇到任何问题，请：

1. 查看浏览器控制台错误信息
2. 检查服务器日志
3. 确认所有依赖服务正常运行
4. 验证环境变量配置

## 📝 更新日志

### v2.2.0 🎉
- 🔒 移除默认管理员账户，强制使用环境变量
- 🎨 全新高级UI设计，采用玻璃态效果
- 🐛 修复侧边栏布局问题
- ✨ 改进登录页面设计
- 🚀 优化整体性能和用户体验
- 📱 增强响应式设计

### v2.1.0
- 新增现代化UI设计
- 改进响应式布局
- 增强数据可视化
- 优化性能表现

## 💡 最佳实践

### 部署建议：
1. 使用强密码
2. 定期更换管理员密码
3. 启用HTTPS
4. 限制管理后台访问IP
5. 定期备份数据库
6. 监控系统日志

### 安全检查清单：
- [ ] 已设置强密码
- [ ] 已启用HTTPS
- [ ] 已配置防火墙规则
- [ ] 已设置定期备份
- [ ] 已配置监控告警

## 🎯 环境变量配置示例

### Cloudflare Pages 环境变量：
```
Production:
ADMIN_USERNAME = mycompany_admin
ADMIN_PASSWORD = MySecureP@ssw0rd2024!

Preview:
ADMIN_USERNAME = preview_admin
ADMIN_PASSWORD = PreviewP@ssw0rd2024!
```

### 本地开发 .dev.vars：
```bash
ADMIN_USERNAME=local_admin
ADMIN_PASSWORD=LocalDev@2024!
```

## 📞 联系支持

如需技术支持，请提供以下信息：
- 错误截图
- 浏览器控制台日志
- 部署环境信息
- 复现步骤

---

**注意**: 请妥善保管您的管理员凭据，不要在公共场所或不安全的环境中暴露这些信息。