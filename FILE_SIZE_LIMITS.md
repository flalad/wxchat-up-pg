# 文件大小限制说明和修改指南

## 📊 当前文件大小限制

### 前端限制
- **当前限制**: 10MB (`CONFIG.FILE.MAX_SIZE = 10 * 1024 * 1024`)
- **配置位置**: [`public/js/config.js`](public/js/config.js:18)
- **验证位置**: [`public/js/utils.js`](public/js/utils.js:88-90)

### Cloudflare 平台限制

#### Workers 限制
- **请求体大小**: 100MB (免费版)
- **请求体大小**: 500MB (付费版)
- **执行时间**: 10秒 (免费版) / 30秒 (付费版)

#### Pages Functions 限制
- **请求体大小**: 100MB (免费版)
- **请求体大小**: 500MB (付费版)
- **执行时间**: 10秒 (免费版) / 30秒 (付费版)

#### R2 存储限制
- **单个对象大小**: 5TB (理论上限)
- **实际建议**: 5GB 以下获得最佳性能

## 🎯 修改为1GB限制的方案

### 方案一：直接修改限制（推荐）

适用于付费版 Cloudflare 账户，可以支持1GB文件上传。

#### 1. 修改前端配置

```javascript
// public/js/config.js
FILE: {
    MAX_SIZE: 1024 * 1024 * 1024, // 1GB (1024MB)
    ALLOWED_TYPES: '*',
    CHUNK_SIZE: 1024 * 1024 // 1MB chunks
},

ERRORS: {
    FILE_TOO_LARGE: '文件大小不能超过1GB', // 更新错误提示
    // ... 其他配置
}
```

#### 2. 更新文档说明

```markdown
- 📄 **文件传输**: 支持各种格式文件的上传和下载（最大1GB）
```

### 方案二：分片上传（推荐大文件）

对于超大文件，实现分片上传机制，提高上传成功率。

#### 优势
- 支持断点续传
- 减少内存占用
- 提高上传成功率
- 支持上传进度显示

#### 实现要点
- 将大文件分割为多个小块（如10MB）
- 逐个上传文件块
- 在服务端重新组装文件
- 支持上传失败重试

## 🚀 快速修改步骤

### 步骤1：修改前端配置
```bash
# 修改 public/js/config.js 中的 MAX_SIZE
```

### 步骤2：更新错误提示
```bash
# 修改 public/js/config.js 中的 FILE_TOO_LARGE 错误信息
```

### 步骤3：更新文档
```bash
# 修改 README.md 中的文件大小说明
```

### 步骤4：重新构建和部署
```bash
npm run build:pages
npm run pages:deploy
```

## ⚠️ 注意事项和限制

### Cloudflare 账户类型要求

#### 免费版限制
- **最大请求体**: 100MB
- **建议文件大小**: 50-80MB 以下
- **超时限制**: 10秒执行时间

#### 付费版支持
- **最大请求体**: 500MB
- **建议文件大小**: 200-400MB 以下
- **超时限制**: 30秒执行时间

### 1GB文件上传的挑战

1. **网络稳定性**: 大文件上传需要稳定的网络连接
2. **超时风险**: 可能超过 Cloudflare 的执行时间限制
3. **内存占用**: 大文件会占用更多内存资源
4. **用户体验**: 上传时间较长，需要良好的进度提示

## 🛠️ 实际修改代码

让我为你提供具体的修改代码：